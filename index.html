<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Grocery Outlet PLU List</title>
<link rel="icon" type="image/png" href="icon.png">
<script src="produceList.js"></script>


<style>
  body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    /* Gradient background */
    background: linear-gradient(135deg, #ffd89b, #19547b);
    transition: background 0.5s ease;
  }

  #safe-btn,
  #hide-btn,
  .increment-btn,
.decrement-btn {
    display: none !important; /* completely hide them */
    pointer-events: none !important; /* just in case */
  }
  .container {
    position: relative; /* needed for Safe button positioning */
    background: rgba(255, 255, 255, 0.95);
    width: 400px;
    padding: 30px 25px;
    border-radius: 20px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.3);
    display: flex;
    
    flex-direction: column;
    gap: 20px;
  }
.add-btn {
  padding: 14px 28px;        /* larger tap area */
  font-size: 18px;           /* bigger text */
  border-radius: 12px;       /* rounded like your other buttons */
  background: #ff7b7b;       /* matches refresh button */
  color: #fff;
  border: none;
  cursor: pointer;
  margin-left: 10px;         /* spacing from input */
  transition: background 0.2s ease;
}

.add-btn:hover {
  background: #ff5252;       /* hover effect */
}


  h1 {
    font-size: 20px;
    margin: 0 0 10px 0;
    text-align: center;
  }

  #search-bar {
    width: 100%;
    padding: 12px 15px;
    border-radius: 15px;
    border: 1px solid #ccc;
    font-size: 16px;
    box-sizing: border-box;
  }

  ul {
    list-style: none;
    padding: 0;
    margin: 0;
    max-height: 200px;
    overflow-y: auto;
    border-radius: 10px;
  }

  li {
    padding: 10px;
    margin-bottom: 5px;
    background: #f7f7f7;
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.2s ease;
  }

  li:hover {
    background: #d3f3ff;
  }

  #scanned-items li {
    background: #fff7d3;
    cursor: default;
  }

  #refresh-btn {
    padding: 12px 20px;
    border: none;
    border-radius: 50px;
    background: #ff7b7b;
    color: #fff;
    font-size: 16px;
    cursor: pointer;
    align-self: center;
    transition: background 0.2s ease;
  }

  #refresh-btn:hover {
    background: #ff5252;
  }

  .number-input {
    width: 60px;
    font-size: 16px;
    padding: 5px;
    margin-left: 10px;
  }

  /* Safe button */
  #safe-btn {
    position: absolute;
    top: 10px;
    right: 10px;
    padding: 6px 12px;
    font-size: 12px;
    border: none;
    border-radius: 8px;
    background: #7b7bff;
    color: #fff;
    cursor: pointer;
    z-index: 10;
    transition: background 0.2s ease;
  }

  #safe-btn:hover {
    background: #5252ff;
  }

    #hide-btn {
    position: absolute;
    top: 10px;
    left: 10px;
    padding: 6px 12px;
    font-size: 12px;
    border: none;
    border-radius: 8px;
    background: #7d7e7e;
    color: #fff;
    cursor: pointer;
    z-index: 10;
    transition: background 0.2s ease;
    }

    #hide-btn:hover {
    background: #52ff52;
    }
.add-btn {
  padding: 12px 25px;
  font-size: 16px;
  border-radius: 12px;
  background: #ff7b7b;
  color: #fff;
  border: none;
  cursor: pointer;
  margin-left: 10px;
  transition: background 0.2s ease;
}

.add-btn:hover {
  background: #ff5252;
}
#watermark {
  position: absolute;      /* fixes it relative to the viewport */
  bottom: 0px;            /* distance from bottom */
  right: 0px;             /*distance from right*/
  height: 10vh;            /* 20% of viewport height */
  width: auto;             /* maintain aspect ratio */
  opacity: 0.06;            /* subtle watermark */
  pointer-events: none;    /* won’t block clicks */
  z-index: 1;              /* behind container if needed */
}


</style>
</head>
<body>

<div class="container">
    <button id="hide-btn">Hide</button>

  <button id="safe-btn">Safe</button>

  <h1>Produce Plu </h1>
  <input type="text" id="search-bar" placeholder="Type PLU or name..." autocomplete="off" />
  <ul id="search-results"></ul>
  <h3>Scanned Out</h3>
  <ul id="scanned-items"></ul>
  <button id="refresh-btn">Refresh Session</button>
</div>
<img src="dango.png" alt="Watermark" id="watermark">

<script>
// ---------------- Background Cycling ----------------
const body = document.body;
let safeMode = false;
let bgImages = [];
let currentBgIndex = 0;

// Load images dynamically (1.png, 2.png, ..., max 50)
(function loadBackgrounds() {
  for (let i = 1; i <= 50; i++) {
    const img = new Image();
    img.src = `background/${i}.png`;
    img.onload = () => {
      bgImages.push(img.src);
    };
  }
})();

function setRandomBackground() {
  if (!safeMode && bgImages.length > 0) {
    const index = Math.floor(Math.random() * bgImages.length);
    body.style.backgroundImage = `url('${bgImages[index]}')`;
  }
}

// Initial random background
setTimeout(setRandomBackground, 500);

// Safe button toggle
const safeBtn = document.getElementById("safe-btn");
safeBtn.addEventListener("click", () => {
  safeMode = !safeMode;
  if (safeMode) {
    body.style.backgroundImage = "url('background/safe.png')";
  } else {
    setRandomBackground();
  }
});


// Elements
const searchBar = document.getElementById("search-bar");
const searchResults = document.getElementById("search-results");
const scannedItemsEl = document.getElementById("scanned-items");
const refreshBtn = document.getElementById("refresh-btn");

// Load scanned items from localStorage
let scannedItems = JSON.parse(localStorage.getItem("scannedItems")) || [];

// Render scanned items
function renderScanned() {
  scannedItemsEl.innerHTML = "";

  scannedItems.forEach((item, index) => {
    const li = document.createElement("li");

    li.textContent = `${item.name} (${item.plu}) - ${item.quantity} ${item.type}`;

    // ⭐ Remove item when tapped
    li.addEventListener("click", () => {
      scannedItems.splice(index, 1); // remove from array
      saveScanned();
      renderScanned(); // redraw list
    });

    scannedItemsEl.appendChild(li);
  });
}

// Save scanned items to localStorage
function saveScanned() {
  localStorage.setItem("scannedItems", JSON.stringify(scannedItems));
}

// Search functionality
searchBar.addEventListener("input", () => {
  const query = searchBar.value.toLowerCase();
  searchResults.innerHTML = "";

  const filtered = produceList.filter(item =>
    item.name.toLowerCase().includes(query) || item.plu.includes(query)
  );

  filtered.forEach(item => {
    const li = document.createElement("li");
    li.textContent = `${item.name} (${item.plu})`;
    li.addEventListener("click", () => selectItem(item));
    searchResults.appendChild(li);
  });
});

// Select item and input quantity/lbs
function selectItem(item) {
  const input = document.createElement("input");
  input.type = "number";
  input.min = 1;
  input.value = 1;
  input.className = "number-input";
  input.style.width = "60px"; // fits nicely for typing

  const confirmBtn = document.createElement("button");
  confirmBtn.textContent = "Add";
  confirmBtn.className = "add-btn"; // for styling

  const tempLi = document.createElement("li");
  tempLi.textContent = `${item.name} (${item.plu}) - Enter ${item.type === 'lb' ? 'weight (lbs)' : 'quantity'}: `;
  tempLi.appendChild(input);
  tempLi.appendChild(confirmBtn);

  searchResults.innerHTML = "";
  searchResults.appendChild(tempLi);

  // Confirm add
  confirmBtn.addEventListener("click", () => {
    const quantity = parseFloat(input.value);
    if (isNaN(quantity) || quantity < 1) return; // prevent invalid entries

    // Merge duplicates
    const existingItem = scannedItems.find(i => i.plu === item.plu);
    if (existingItem) {
      existingItem.quantity += quantity;
    } else {
      scannedItems.push({ ...item, quantity });
    }

    saveScanned();
    renderScanned();
    searchResults.innerHTML = "";
    searchBar.value = "";
  });

  input.focus();
  input.select(); // so typing immediately overwrites the default 1
}


// Refresh session with PIN
refreshBtn.addEventListener("click", () => {
  const pin = prompt("Enter PIN:");

  if (pin === "0000") {
    // Clear session
    scannedItems = [];
    saveScanned();
    renderScanned();

  } else if (pin === "0001") {
    // Go to edits page
    window.location.href = "edits.html";

  } else if (pin !== null) {
    alert("Incorrect PIN!");
  }
});


const hideBtn = document.getElementById("hide-btn");
const container = document.querySelector(".container");

hideBtn.addEventListener("click", () => {
  if (container.style.display === "none") {
    container.style.display = "flex"; // show again
    hideBtn.textContent = "Hide";
  } else {
    container.style.display = "none"; // hide container
  }
});


// Initial render
renderScanned();
</script>

</body>
</html>
